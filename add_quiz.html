<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <title>Foundation 4</title>

  <link rel="stylesheet" href="css/foundation.css" />
  <link rel="stylesheet" href="css/main.css" />

  <script type="text/javascript" src="//use.typekit.net/xuo4ojj.js"></script>
  <script src="http://www.parsecdn.com/js/parse-1.2.8.min.js"></script>
  <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
  <script src="js/vendor/custom.modernizr.js"></script>

</head>

<body>

  <header>
    <div class="row">
      <div class="large-12 columns text-center">
        <h2>Involved</h2>
      </div>
    </div>
  </header>
  <form>
    <fieldset>
      <legend>New Quiz</legend>

      <div class="row">
        <div class="question_template">
          <div class="large-12 columns">
            <label>Question</label>
            <input id="quiz_question" type="text" placeholder="Enter the question you'd like displayed to the students">
          </div>

        <div id="answers" >
          <div class="answer_template">
            <div class="row answer_field">
              <div class="large-12 columns">
                <label>Answer</label>
                <input type="text" class='an_answer' placeholder="Enter one of the possible answers">
              </div>
            </div>
          </div> 
        </div>

        <div class="row">
          <div class="columns">
          <button href="#" class="button round" id="add_answer">Add Answer</button>
          </div>
        </div>
      </div>

        <div class="row">
          <div class="columns">
          <button href="#" class="button round" id="add_question">Add Question</button>
          </div>
        </div>

      <div class="row">
        <div class="large-12 large-centered columns">
          <button id="save_quiz" class="button large">Save Quiz</button>
        </div>
      </div>
    </fieldset>
  </form>

  <script>
    document.write('<script src=' +
                   ('__proto__' in {} ? 'js/vendor/zepto' : 'js/vendor/jquery') +
                   '.js><\/script>')
  </script>

  <script src="js/foundation.min.js"></script>
  <!--

  <script src="js/foundation/foundation.js"></script>
  <script src="js/foundation/foundation.alerts.js"></script>
  <script src="js/foundation/foundation.clearing.js"></script>
  <script src="js/foundation/foundation.cookie.js"></script>
  <script src="js/foundation/foundation.dropdown.js"></script>
  <script src="js/foundation/foundation.forms.js"></script>
  <script src="js/foundation/foundation.joyride.js"></script
  <script src="js/foundation/foundation.magellan.js"></script>
  <script src="js/foundation/foundation.orbit.js"></script>
  <script src="js/foundation/foundation.reveal.js"></script>
  <script src="js/foundation/foundation.section.js"></script>
  <script src="js/foundation/foundation.tooltips.js"></script>
  <script src="js/foundation/foundation.topbar.js"></script>
  <script src="js/foundation/foundation.interchange.js"></script>
  <script src="js/foundation/foundation.placeholder.js"></script>
  -->

  <script>
    $(document).foundation();
    Parse.initialize("EeEFArcfnsV0d1uVCJ4K5j6y86se3cyKP5bEigcm", "TuWtuZ7iXYxkxOar3vwlVFq2jOpkHTPRilxSjllC");
    //var TestObject = Parse.Object.extend("TestObject");
    //var testObject = new TestObject();

    $('#add_answer').click(function() {
      event.preventDefault();
      $('#answers').append($('.answer_template').html());
    });

    $('#add_question').click(function() {
      event.preventDefault();
      $('#answers').append($('.question_template').html());
    });
    

    var Quiz = Parse.Object.extend("Quiz");
    var Question = Parse.Object.extend("Question");

    $('#save_quiz').click(function(event){
      event.preventDefault();
      console.log('hoping to save quiz')

      //save each question
      var questions = $('#quiz_question').each(function(index,item) {
        console.log('iterating through questions')
        var question = new Question();
        var questionString = $(item).val();
        var answers = new Array;
        $('.answer_field .an_answer').each(function(index,item) {
            answers.push($(item).val());
            console.log('answers')
        });

        question.save({
          question: questionString,
          answers: answers,
        }, {
          success: function(quiz) {
          console.log('Question saved apparently. Quiz id:' + question.id)
        },
          error: function(quiz, error) {
          // The save failed.
          // error is a Parse.Error with an error code and description.
          }
        });
      })

      //save each Quiz

    })
    //Querying
    var quizes = new Parse.Query(Quiz);
    quizes.each(function(quiz){console.log(quiz.get('question'))})
  </script>
</body>
</html>
